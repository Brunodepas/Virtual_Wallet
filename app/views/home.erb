<h2>Saldo: <%= current_user.accounts.first.balance %> </h2>
<h2>Puntos: <%= current_user.accounts.first.amount_point %> </h2>

<div style="position: absolute; top: 120px; right: 20px; width: 300px; background: #eee; padding: 15px; border-radius: 8px;">
  <h3 style="margin-top: 0;">Historial</h3>

  <% if @movements.any? %>
    <% @movements.each do |m| %>
      <% name = if m.user == current_user
        m.destination&.user&.person
      else
        m.origin&.user&.person
      end %>

      <div style="margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
        <span style="color: #666; font-size: 0.9em;">
          <% if m.movement_type == "Ingreso" %>
            Ingreso de dinero
          <% else %>
            <%= m.user == current_user ? "Transferencia enviada a" : "Transferencia recibida de" %>
          <% end %>
        </span><br>

        <span style="font-size: 1em; color: #333;">
          <%= "#{name&.first_name} #{name&.last_name}".strip.presence%>
        </span><br>

        <span style="color: <%= m.user == current_user ? 'red' : 'green' %>; font-size: 0.95em;">
          <%= m.user == current_user ? "-" : "+" %>$<%= sprintf('%.2f', m.amount) %>
        </span><br>

        <span style="color: #999; font-size: 0.85em;">
          <%= m.created_at.strftime("%H:%M hs · %d/%m") %>
        </span>
      </div>
    <% end %>
  <% else %>
    <p>No hay movimientos recientes para mostrar.</p>
  <% end %>

  <a href="/history">Ver más</a>
</div>
